<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Phaser - Making your first game, part 1</title>
    <script src="//cdn.jsdelivr.net/phaser/2.2.2/phaser.min.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">
    var game = new Phaser.Game(800, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update });
    function preload() {
        game.load.image('phaser', 'phaser.png');
    }

    var graphics;

    var p1_head;
    var p1_body;

    var lastX;
    var lastY;

    function create() {
        graphics = game.add.graphics(0, 0);

        graphics.beginFill(0xFF3300);
        //graphics.lineStyle(10, 0xffd900, 1);

        graphics.drawCircle(300,400,20);

        //  Then generate a texture from it and apply the texture to the sprite
        p1_head = game.add.sprite(400, 300, graphics.generateTexture());
        p1_head.anchor.set(0.5);
        game.physics.arcade.enable(p1_head);

        p1_body = game.add.group();


        //  And destroy the original graphics object
        graphics.destroy();



    }

    function update() {

        /*
         1. Draw line from last pos to current.
         2. Make into sprite.
         3. Add sprite to group.
         */

        graphics = game.add.graphics(0, 0);
        graphics.beginFill(0xFF3300);
        graphics.lineStyle(10, 0xffd900, 1);
        graphics.moveTo(lastX,lastY);
        graphics.lineTo(p1_head.x,p1_head.y);
        graphics.drawCircle(p1_head.x, p1_head.y, 5);
        graphics.endFill();

        var sprite = game.add.sprite(p1_head.x, p1_head.y, graphics.generateTexture());
        sprite.anchor.set(0.5);

        p1_body.add(sprite);

        lastX = p1_head.x;
        lastY = p1_head.y;



        game.physics.arcade.accelerateToPointer(p1_head,Phaser.Input.activePointer, 200,200,200);
        graphics.destroy();
    }


</script>

</body>
</html>